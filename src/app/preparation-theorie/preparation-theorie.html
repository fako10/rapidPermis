<div class="prepa-container">
  <!-- Header -->
  <header class="prepa-header">
    <h1 class="prepa-title">üöó Pr√©paration √† l'examen th√©orique</h1>

    <div class="prepa-buttons">
      <button
        class="prepa-btn prepa-btn-training"
        [class.prepa-btn-active]="mode === 'training'"
        (click)="selectMode('training')">
        Mode Entra√Ænement
      </button>

      <button
        class="prepa-btn prepa-btn-simulation"
        [class.prepa-btn-active]="mode === 'simulation'"
        (click)="selectMode('simulation')">
        Mode Simulation
      </button>

      <button *ngIf="!isEnabled"
        class="prepa-btn prepa-btn-simulation"
        [class.prepa-btn-active]="mode === 'payment'"
        (click)="selectMode('payment')">
        payer
      </button>
    </div>
  </header>

  <!-- Contenu principal -->
  <main class="prepa-main">

    <!-- Si aucun mode -->
    <div *ngIf="!mode" class="prepa-empty">
      <p>Choisissez un mode pour commencer votre pr√©paration üëá</p>
    </div>

    <!-- Mode Entra√Ænement -->
    <div *ngIf="mode === 'training'" class="prepa-section">
      <h2 class="prepa-section-title">üß† Cat√©gories d'entra√Ænement</h2>

      <div class="prepa-grid">
        <div *ngFor="let cat of categories" class="prepa-card"  [ngClass]="{ 'disabled': isEnabled }">

          <div class="prepa-card-icon">{{ cat.icon }}</div>
          <div class="prepa-card-title">{{ cat.name }}</div>
          <button class="prepa-card-btn" (click)="ouvrirPopup(cat)">Commencer l'entra√Ænement</button>
        </div>

      </div>

      <!-- POPUP CUSTOM -->
      <div class="overlay" *ngIf="popupVisible" (click)="fermerPopup()"></div>

      <div class="popup" *ngIf="popupVisible">

        <h3>{{ categorieCourante?.name }}</h3>

        <!-- Loader -->
        <div *ngIf="loading">Chargement des activit√©s...</div>

        <!-- Erreur backend -->
        <div *ngIf="error" class="error">{{ error }}</div>

        <!-- Liste des activit√©s -->
        <ul *ngIf="!loading && !error">
          <li *ngFor="let act of activites" (click)="lancerActivite(act.id)">
            {{ act.libelle }}
          </li>
        </ul>

        <button class="close-btn" (click)="fermerPopup()">Fermer</button>
      </div>


    </div>

    <!-- Mode Simulation -->
    <div *ngIf="mode === 'simulation'" class="prepa-section">
      <h2 class="prepa-section-title">üéØ Examens de simulation</h2>



      <div class="prepa-grid">
        <div
          *ngFor="let sim of simulations"
          class="prepa-card"
          [ngClass]="{ 'disabled': !isEnabled }"
        >
          <div class="prepa-card-title">{{ sim.title }}</div>
          <div class="prepa-card-info">
            {{ sim.questions }} questions ‚Äî {{ sim.duration }} min
          </div>
          <button
            class="prepa-card-btn"
            (click)="startSimulation(sim)"
            [disabled]="!sim.isAvailable"
          >
            Commencer
          </button>
        </div>
      </div>

      <br>
      <h2 class="prepa-section-title">üéØ historique des examens pass√©s</h2>

    </div>



    <section class="payment" *ngIf="mode === 'payment'">
      <div class="container">
        <h2>Paiement s√©curis√©</h2>

        <!-- Bloc 1 : Choix de l‚Äôoffre -->
        <div class="block">
          <h3>üì¶ Choisissez votre formule</h3>
          <p style="text-align: justify;">
            S√©lectionnez l‚Äôoffre qui correspond le mieux √† vos besoins : acc√®s illimit√© √† toutes les questions,
            pack examen blanc ou formule compl√®te avec suivi personnalis√©. Chaque option est con√ßue pour vous
            accompagner efficacement jusqu‚Äô√† la r√©ussite de votre permis.
          </p>
          <div class="offers">
            <div class="offer">
              <h4>Pack D√©couverte</h4>
              <p>Acc√®s 7 jours ‚Ä¢ 500 questions</p>
              <p class="price">9,99 ‚Ç¨</p>
              <button class="btn" (click)="pay('DECOUVERTE', 999)">Choisir</button>
            </div>
            <div class="offer">
              <h4>Pack Standard</h4>
              <p>Acc√®s 1 mois ‚Ä¢ 1500 questions + examens blancs</p>
              <p class="price">19,99 ‚Ç¨</p>
              <button class="btn">Choisir</button>
            </div>
            <div class="offer">
              <h4>Pack Confort</h4>
              <p>Acc√®s 3 mois ‚Ä¢ Tout inclus + suivi personnalis√©</p>
              <p class="price">29,99 ‚Ç¨</p>
              <button class="btn">Choisir</button>
            </div>

            <div class="offer">
              <h4>Pack Premium</h4>
              <p>Acc√®s illimit√© ‚Ä¢ Tout inclus + suivi personnalis√©</p>
              <p class="price">39,99 ‚Ç¨</p>
              <button class="btn">Choisir</button>
            </div>
          </div>
        </div>





      </div>
    </section>

  </main>


</div>





